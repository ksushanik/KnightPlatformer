# План реорганизации и минимизации кода

## Этап 1: Разделение модулей
- [x] **Создать скрипт UIManager (scripts/ui_manager.gd)**
  - [x] Перенести всю UI логику (уведомления, жизни, Game Over экран)
  - [x] Настроить связь с GameManager через сигналы

- [x] **Создать скрипт InventorySystem (scripts/inventory_system.gd)**
  - [x] Перенести весь код работы с инвентарём
  - [x] Реализовать API для добавления/проверки предметов

- [x] **Создать LevelSystem (scripts/level_system.gd)**
  - [x] Перенести логику изменения уровней 
  - [x] Создать механизм управления последовательностью уровней

- [x] **Создать PlayerStateManager (scripts/player_state_manager.gd)**
  - [x] Перенести логику состояний игрока (жив/мёртв, диалог)
  - [x] Использовать enums вместо булевых флагов

## Этап 2: Рефакторинг GameManager
- [x] **Очистить game_manager.gd от UI кода**
  - [x] Удалить функции создания UI элементов
  - [x] Заменить прямые вызовы UI на сигналы

- [x] **Вынести логику инвентаря**
  - [x] Удалить методы работы с инвентарём
  - [x] Добавить ссылку на InventorySystem

- [x] **Упростить обработку уровней**
  - [x] Минимизировать код перехода между уровнями
  - [x] Поддерживать только ключевую логику

- [x] **Удалить избыточное логирование**
  - [x] Оставить только критически важный debug вывод

## Этап 3: Наладить взаимодействие между модулями
- [x] **Настроить систему сигналов**
  - [x] GameManager -> UIManager
  - [x] GameManager -> InventorySystem
  - [x] GameManager -> LevelSystem

- [x] **Создать сцены для компонентов**
  - [x] Создать ui_manager.tscn
  - [x] Создать inventory_system.tscn
  - [x] Создать level_system.tscn
  - [x] Создать player_state_manager.tscn
  - [x] Обновить game_manager.tscn

- [x] **Обновить ссылки в существующем коде**
  - [x] Обновить scripts/main_title.gd
  - [x] Обновить scripts/level_controller.gd
  - [x] Обновить scripts/level_0_controller.gd
  - [x] Обновить scripts/element.gd
  - [x] Обновить scripts/camera_controller.gd

## Этап 4: Тестирование
- [ ] **Проверить каждую игровую механику**
  - [ ] Жизни игрока (отображение, уменьшение, Game Over)
  - [ ] Инвентарь (добавление, просмотр)
  - [ ] Переходы между уровнями
  - [ ] Диалоги и взаимодействия

- [ ] **Проверить крайние случаи**
  - [ ] Смерть во время диалога
  - [ ] Сбор предметов в разных ситуациях
  - [ ] Переход на несуществующий уровень

## Примечания
- Я буду автоматически обновлять этот файл и отмечать выполненные пункты
- При необходимости план может корректироваться в процессе работы
- После выполнения всех пунктов провести дополнительное тестирование 